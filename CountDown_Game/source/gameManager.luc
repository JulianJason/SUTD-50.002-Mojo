/*
  Game manager is the judge for the game
  This module handles everything and is the so-called "smart" component
*/

module gameManager (
    input clk,  // clock
    input rst,  // reset
    // input buttons for easy medium hard, new game buttons
    input easyButton,
    input mediumButton,
    input hardButton,
    input newGameButton,
    input singlePlayerButton,
    input multiplayerButton,
    output difficulty[2],
    output newGameFlag
  ) {
  .clk(clk) {
    .rst(rst) {
      fsm state = {NOT_PLAYING, SINGLE_PLAYER, MULTIPLAYER}; // the multiple playing states 
      fsm difficultyState = {EASY, MEDIUM, HARD}
    }
    dff confirm[1];
    button_conditioner spButtonCond;
    button_conditioner mpbuttonCond;
  }
  always {
    
    difficulty = 0;
    newGameFlag = 0;
    if (easyButton) {
        difficultyState.d = difficultyState.EASY;
    } else if (mediumButton) {
        difficultyState.d = difficultyState.MEDIUM;
    } else if (hardButton) {
        difficultyState.d = difficultyState.HARD;
    }
    spButtonCond.in = singlePlayerButton;
    mpbuttonCond.in = multiplayerButton;
    if (spButtonCond.out) {
      if (state.q != state.NOT_PLAYING && confirm.q == 1) {
          confirm.d = 0;
          state.d = state.NOT_PLAYING;
          newGameFlag = 1;
      } else {
       confirm.d = 1; 
      }
    } else if (mpbuttonCond.out) {
      if (state.q != state.NOT_PLAYING && confirm.q == 1) {
          confirm.d = 0;
          state.d = state.NOT_PLAYING;
          newGameFlag = 1;
      } else {
       confirm.d = 1; 
      }
    }
    // if not playing
    
    
    // else if new game button is pressed, reset game
    if (newGameButton) {
      newGameFlag = 0;
      game_state.d = state.NOT_PLAYING;
    }
    
    difficulty = difficultyState.q;
  }
}
